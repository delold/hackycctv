{"version":3,"sources":["components/Scrobber/Scrobber.module.css","components/Menu/Menu.module.css","components/Menu/Menu.tsx","routes/Home/Home.tsx","components/Live/Live.tsx","components/Dvr/Dvr.tsx","components/Timeline/Timeline.tsx","components/Scrobber/Scrobber.tsx","constants.ts","routes/Camera/Camera.tsx","App.tsx","index.tsx"],"names":["module","exports","timeline","scrobber","slider","day","position","bubble","button","hidden","header","active","btn","hide","Menu","state","showMenu","handleOnMenu","navigator","vibrate","err","_this","setState","enableNoSleep","react_default","a","createElement","className","styles","this","undefined","props","streams","map","_ref","name","key","react_router_dom","activeClassName","to","concat","onClick","Component","Home","Livestream","ms","video","objectUrl","socket","socketTimeout","frameBuffer","socketConnect","WebSocket","source","binaryType","onopen","console","log","onmessage","data","push","Uint8Array","doAppend","paused","play","onerror","close","onclose","clearTimeout","setTimeout","onUpdateEnd","length","frame","shift","sourceBuffers","sourceBuffer","updating","appendBuffer","onSourceOpen","addSourceBuffer","addEventListener","onRef","dom","src","createDecoder","MediaSource","window","URL","createObjectURL","destroyDecoder","removeAttribute","load","revokeObjectURL","endOfStream","removeEventListener","oldProps","ref","DVR","hls","timer","videoRef","handlePlayback","autoplay","Hls","isSupported","pause","destroy","loadSource","attachMedia","on","Events","MANIFEST_PARSED","style","autoPlay","muted","playsinline","DAY_LENGTH","MAX_LENGTH","SIZE_MULTIPLIER","TIME_PER_PIXEL","Timeline","canvas","timeToPx","time","timestampToPx","timestamp","current","getRef","draw","_this$props","scenes","ctx","getContext","width","height","lineWidth","strokeStyle","beginPath","moveTo","forEach","scene","x","y","lineTo","stroke","fillStyle","textBaseline","font","now","minDay","ofDay","moment","startOf","valueOf","startX","endX","arc","Math","PI","closePath","fillText","format","newProps","Scrobber","debounce","interval","timeout","sceneTimer","Date","visible","onShift","ceil","performTick","callback","max","getMilliseconds","extendOpacity","handleScroll","scrollLeft","addRef","handleLive","handlePlayPause","_this$state","newShift","offsetWidth","onStop","handleShift","seconds","px","min","handleShiftRight","handleShiftLeft","document","_this$state2","opacity","toLocaleString","components_Timeline_Timeline","API_URL","Camera","from","showTools","generateUrl","baseUrl","type","params","join","handlePause","handleShiftChange","url","camera","indexOf","Dvr_DVR","Live_Livestream","Scrobber_Scrobber","App","_this2","fetch","headers","Authorization","btoa","credentials","then","json","_this3","id","Menu_Menu","react_router","path","component","render","_ref2","match","Camera_Camera","ReactDOM","App_App","getElementById"],"mappings":"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","file":"static/js/main.c895a20a.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"timeline\":\"Scrobber_timeline__2QMUb\",\"scrobber\":\"Scrobber_scrobber__13cT7\",\"slider\":\"Scrobber_slider__2qtzj\",\"day\":\"Scrobber_day__3V_gH\",\"position\":\"Scrobber_position__21tsl\",\"bubble\":\"Scrobber_bubble__1Z5Vj\",\"button\":\"Scrobber_button__2QFrl\",\"hidden\":\"Scrobber_hidden__3BlCq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Menu_header__13Hex\",\"active\":\"Menu_active__1QS5y\",\"btn\":\"Menu_btn__2c26E\",\"hide\":\"Menu_hide__1klpX\"};","import React, { Component } from 'react'\nimport styles from './Menu.module.css'\nimport { NavLink } from 'react-router-dom'\n\ntype Props = {\n  streams: {\n    name: string,\n    key: string,\n    port: number,\n  }[]\n}\n\nexport default class Menu extends Component<Props> {\n\tstate = {\n\t\tshowMenu: false,\n\t}\n\n\thandleOnMenu = () => {\n\t\ttry {\n\t\t\tnavigator.vibrate(100)\n\t\t} catch (err) {}\n\t\tthis.setState({ showMenu: !this.state.showMenu })\n\t}\n\n\tcomponentDidMount() {\n\t\t// this.wakelock = new NoSleep()\n\t}\n\n\tcomponentWillUnmount() {\n\t\t// if (this.wakelock) {\n\t\t// \tthis.wakelock.disable()\n\t\t// }\n\t}\n\n\tenableNoSleep = () => {\n\t\ttry {\n\t\t\tnavigator.vibrate(100)\n\t\t} catch (err) {}\n\n\t\tthis.handleOnMenu()\n\t\t// if (this.wakelock) {\n\t\t// \tthis.wakelock.enable()\n\t\t// }\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<header className={styles.header}>\n\t\t\t\t<h1>Kamera</h1>\n\t\t\t\t<nav className={this.state.showMenu ? undefined : styles.hide}>\n\t\t\t\t\t{ this.props.streams.map(({ name, key }) => (\n\t\t\t\t\t\t<NavLink activeClassName={styles.active} to={`/camera/${key}`} key={key}>{name}</NavLink>\n\t\t\t\t\t))}\n\t\t\t\t</nav>\n\t\t\t\t<a className={styles.btn} onClick={this.handleOnMenu}>☰</a>\n\t\t\t</header>\n\t\t);\n\t}\n}\n","import React from 'react'\n\nexport default () => (\n  <div>Home</div>\n)","import React, { Component } from 'react'\n\ntype Props = {\n  source: string,\n}\n\n// ws://${HOST}:${this.props.port}\n\nexport default class Livestream extends Component<Props> {\n  ms: MediaSource | null = null\n  video: HTMLVideoElement | null = null\n  objectUrl: string | null = null\n  socket: WebSocket | null = null\n  socketTimeout: number | null = null\n\n  frameBuffer: Uint8Array[] = []\n  \n  componentDidUpdate(oldProps: Props) {\n    if (oldProps.source !== this.props.source) {\n      this.destroyDecoder()\n      this.createDecoder()\n    }\n  }\n\n  socketConnect = () => {\n    this.socket = new WebSocket(this.props.source)\n    this.socket.binaryType = 'arraybuffer'\n\n    this.socket.onopen = () => console.log('open connection')\n    this.socket.onmessage = ({ data }) => {\n      this.frameBuffer.push(new Uint8Array(data))\n      this.doAppend()\n\n      if (this.video && this.video.paused) {\n        this.video.play()\n      }\n    }\n    \n    this.socket.onerror = () => {\n      console.log('error in socket')\n      if (this.socket) {\n        this.socket.close()\n      }\n    }\n    this.socket.onclose = () => {\n      console.log('closing socket')\n      if (this.socketTimeout !== null) {\n        clearTimeout(this.socketTimeout)\n      }\n\n      const callback: TimerHandler = () => this.socketConnect()\n      this.socketTimeout = setTimeout(callback, 1000)\n    }\n  }\n  \n  onUpdateEnd = () => {\n    this.doAppend()\n  }\n\n  doAppend = () => {\n    if (this.frameBuffer && this.frameBuffer.length > 0) {\n      const frame = this.frameBuffer.shift()\n      if (this.ms && frame && this.ms.sourceBuffers[0]) {\n        const sourceBuffer = this.ms.sourceBuffers[0]\n        if (!sourceBuffer.updating) {\n          sourceBuffer.appendBuffer(frame)\n        }\n      }\n    }\n  }\n\n  onSourceOpen = () => {\n    console.log('source open')\n\n    if (this.ms) {\n      const sourceBuffer = this.ms.addSourceBuffer('video/mp4;codecs=avc1.42001f')\n      sourceBuffer.addEventListener('updateend', this.onUpdateEnd)\n      this.socketConnect()\n    }\n  }\n\n  onRef = (dom: HTMLVideoElement) => {\n    this.video = dom\n    if (!this.video) return\n\n    if (this.objectUrl) {\n      this.video.src = this.objectUrl\n    } else {\n      this.createDecoder()\n    }\n  }\n\n  createDecoder = () => {\n    if (!this.props.source) return\n  \n    this.ms = new MediaSource()\n    this.ms.addEventListener('sourceopen', this.onSourceOpen, false)\n    this.objectUrl = window.URL.createObjectURL(this.ms)\n\n    if (this.video) {\n      this.video.src = this.objectUrl\n    }\n  }\n\n  destroyDecoder = () => {\n    if (this.socketTimeout !== null) {\n      clearTimeout(this.socketTimeout)\n    }\n\n    if (this.socket) {\n      this.socket.onclose = () => console.log('closing socket without reconnect')\n      this.socket.close()\n    }\n\n    if (this.video) {\n      this.video.removeAttribute('src')\n      this.video.load()\n    }\n\n    if (this.objectUrl) {\n      URL.revokeObjectURL(this.objectUrl)\n    }\n\n    if (this.ms) {\n      try {\n        this.ms.endOfStream();\n      } catch(err) {\n      }\n\n      this.ms.removeEventListener('sourceopen', this.onSourceOpen)\n    }\n\n    this.ms = null\n    this.objectUrl = null\n  }\n\n\tcomponentWillUnmount() {\n    this.destroyDecoder()\n  }\n\n\trender() {\n\t\treturn (\n\t\t\t<div>\n        <video ref={this.onRef}></video>\n      </div>\n\t\t)\n\t}\n}\n","import React, { Component } from 'react'\nimport Hls from 'hls.js'\nimport style from './Dvr.module.css'\n\ntype Props = {\n  source: string,\n}\n\nexport default class DVR extends Component<Props> {\n  hls: Hls | null = null\n  timer: number | null  = null\n  ref: HTMLVideoElement | null = null\n\n  componentDidMount() {\n    this.handlePlayback()\n  }\n\n  componentDidUpdate(oldProps: Props) {\n    if (oldProps.source !== this.props.source) {\n      this.handlePlayback()\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.timer !== null) {\n      clearTimeout(this.timer)\n    }\n\n    if (this.ref) {\n      this.ref.pause()\n    }\n    if (this.hls) {\n      this.hls.destroy()\n    }\n  }\n\n  videoRef = (ref: HTMLVideoElement) => {\n    this.ref = ref\n    this.handlePlayback()\n  }\n\n  autoplay: TimerHandler = () => {\n    if (this.ref) this.ref.play()\n  }\n\n  handlePlayback = () => {\n    const { source } = this.props\n\n    if (source && this.ref) {\n      if (this.timer !== null) {\n        clearTimeout(this.timer)\n      }\n      \n      if (Hls.isSupported()) {\n        if (this.hls) {\n          this.ref.pause()\n          this.hls.destroy()\n        }\n\n        this.hls = new Hls()\n        this.hls.loadSource(source)\n        this.hls.attachMedia(this.ref)\n        this.hls.on(Hls.Events.MANIFEST_PARSED, () => {\n            this.timer = setTimeout(this.autoplay, 300)\n\n        })\n      } else {\n        this.ref.src = source\n        setTimeout(this.autoplay, 300)\n      }\n    }\n  }\n\n  render() {\n    return <video className={style.video} ref={this.videoRef} autoPlay muted playsinline />\n  }\n}\n","import React, { Component } from 'react'\nimport moment from 'moment'\n\nexport const DAY_LENGTH = 24 * 60 * 60 * 1000\nexport const MAX_LENGTH = 7 * DAY_LENGTH\nexport const SIZE_MULTIPLIER = 10\n\nexport const TIME_PER_PIXEL = 30 * 1000\n\nexport type Scene = {\n  timestamp: number,\n  scene: number,\n}\n\ntype Props = {\n  current: number,\n  scenes: Scene[],\n}\n\nclass Timeline extends Component<Props> {\n  canvas: HTMLCanvasElement | null = null\n\n\tcomponentDidMount() {\n\t\tthis.draw()\n\t}\n\n\tshouldComponentUpdate(newProps: Props) {\n\t\treturn newProps.current !== this.props.current || newProps.scenes.length !== this.props.scenes.length\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.draw()\n\t}\n\n\ttimeToPx = (time: number) => {\n\t\treturn time / TIME_PER_PIXEL\n\t}\n\n\ttimestampToPx = (timestamp: number) => {\n\t\tconst { current } = this.props\n\t\treturn this.timeToPx(current - timestamp)\n\t}\n\n\tgetRef = (dom: HTMLCanvasElement) => {\n\t\tthis.canvas = dom\n\t\tthis.draw()\n\t}\n\n\tdraw = () => {\n\t\tconst { current, scenes } = this.props\n\t\tif (!this.canvas || !current) return\n\t\t\n    const ctx = this.canvas.getContext('2d')    \n    if (!ctx) return\n\n\t\tconst width = this.timeToPx(MAX_LENGTH)\n\t\tconst height = 70\n\t\tconst circleRadius = 10\n\n\t\tthis.canvas.width = width\n\t\tthis.canvas.height = height\n\n\t\tctx.lineWidth = 1\n\t\tctx.strokeStyle = '#ff00ff'\n\n\t\tctx.beginPath()\n\t\tctx.moveTo(0, height / 2)\n\t\tscenes.forEach(({ timestamp, scene }) => {\n\t\t\tconst availableHeight = (height - 3) / 2\n\t\t\tconst x = this.timestampToPx(timestamp * 1000)\n\t\t\tconst y = availableHeight - availableHeight * scene\n\t\t\tctx.lineTo(x, y)\n\t\t})\n\n\t\tctx.stroke()\n\n\t\tctx.lineWidth = 3\n\t\tctx.strokeStyle = '#fff'\n\t\tctx.fillStyle = '#fff'\n    ctx.textBaseline = \"bottom\"\n\t\tctx.font = \"16px sans-serif\"\n\t\t\n\t\tlet now = current\n\t\tconst minDay = current - MAX_LENGTH\n\t\tlet shift = 0\n\t\t\n\n\t\twhile (now - shift >= minDay) {\n\t\t\tconst ofDay = now - moment(now).startOf('day').valueOf()\n\n\t\t\tconst startX = this.timeToPx(shift)\n\t\t\tconst endX = this.timeToPx(shift + ofDay)\n\n\t\t\tctx.beginPath()\n\t\t\tctx.arc(endX, height / 2, circleRadius, 0, 2 * Math.PI)\n\t\t\tctx.closePath()\n\t\t\tctx.stroke()\n\n\t\t\tctx.font = '1em sans-serif'\n\t\t\tctx.fillText(moment(now).format('YYYY-MM-DD'), startX + (shift && circleRadius) + 5, height / 2 - 6.5)\n\n\t\t\tctx.beginPath()\n\t\t\tctx.moveTo(startX + (shift && circleRadius), height / 2)\n\t\t\tctx.lineTo(endX - circleRadius, height / 2)\n\t\t\tctx.closePath()\n\t\t\tctx.stroke()\n\n\t\t\tshift += ofDay\n\t\t}\n\n\t}\n\n\t\n\n\trender() {\n\t\treturn <canvas ref={this.getRef} />\n\t}\n}\n\nexport default Timeline","import React, { Component } from 'react'\nimport styles from './Scrobber.module.css'\n\nimport Timeline, { DAY_LENGTH, TIME_PER_PIXEL, SIZE_MULTIPLIER, MAX_LENGTH, Scene } from '../Timeline/Timeline'\n\ntype Props = {\n  onShift: (shift: number) => void,\n  onStop: () => void,\n  name: string,\n}\n\ntype State = {\n  shift: number,\n  current: number,\n  paused: boolean,\n  visible: boolean,\n  scenes: Scene[]\n}\nexport default class Scrobber extends Component<Props, State> {\n  debounce: number | null = null\n  interval: number | null = null\n  timeout: number | null = null\n  sceneTimer: number | null = null\n  timer: number | null = null\n  ref: HTMLDivElement | null = null\n\n\tstate = {\n\t\tshift: 0,\n\t\tcurrent: Date.now(),\n\t\tpaused: false,\n\t\tvisible: true,\n\t\tscenes: [],\n\t}\n\n\tonShift = (shift: number) => {\n    if (this.debounce) {\n      clearTimeout(this.debounce)\n    }\n\n    const callback: TimerHandler = () => {\n\t\t\tthis.props.onShift(Math.ceil(shift / 1000))\n    }\n    \n\t\tthis.debounce = setTimeout(callback, 200)\n\t}\n\n\tperformTick = () => {\n\t\tif (!this.interval) {\n\t\t\tthis.interval = 0\n\t\t}\n\t\t\n\t\tconst current = Date.now()\n    this.setState({ current })\n    \n    if (this.timer !== null) {\n      clearTimeout(this.timer)\n    }\n\n    const callback: TimerHandler = this.performTick\n\t\tthis.timer = setTimeout(callback, Math.max(1000 - new Date(current).getMilliseconds(), 0))\n\t}\n\n\textendOpacity = () => {\n    this.setState({ visible: true })\n    \n    if (this.timeout) {\n      clearTimeout(this.timeout)\n    }\n\n    const callback: TimerHandler = () => this.setState({ visible: false })\n\t\tthis.timeout = setTimeout(callback, 8000)\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.extendOpacity()\n\t\tdocument.addEventListener('touchstart', this.extendOpacity)\n\t\tdocument.addEventListener('mousedown', this.extendOpacity)\n\t\tdocument.addEventListener('mousemove', this.extendOpacity)\n\t\t\n\t\tthis.performTick()\n\t}\n\n\thandleScroll = () => {\n\t\tthis.extendOpacity()\n\n\t\tif (this.ref) {\n\t\t\tif (!this.state.paused) {\n\t\t\t\tconst shift = this.ref.scrollLeft * TIME_PER_PIXEL\n\t\t\t\tthis.setState({ shift })\n\t\t\t\tthis.onShift(shift)\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif (this.ref) {\n\t\t\tthis.ref.removeEventListener('scroll', this.handleScroll)\n\t\t}\n\n\t\tdocument.removeEventListener('mousedown', this.extendOpacity)\n\n\t\tif (this.timer) clearTimeout(this.timer)\n\t\tif (this.debounce) clearTimeout(this.debounce)\n\t\tif (this.timeout) clearTimeout(this.timeout)\n\t\tif (this.sceneTimer) clearTimeout(this.sceneTimer)\n\t}\n\n\taddRef = (ref: HTMLDivElement) => {\n\t\tthis.ref = ref\n\t\t\n\t\tif (this.ref) {\n\t\t\tthis.ref.addEventListener('scroll', this.handleScroll)\n\t\t}\n\t}\n\n\thandleLive = () => {\n\t\ttry {\n\t\t\tnavigator.vibrate(100)\n\t\t} catch (err) {}\n\t\t\n\t\tif (this.ref) {\n\t\t\tthis.ref.scrollLeft = 0\n\t\t\tthis.setState({ paused: false, shift: 0 })\n\t\t\tthis.onShift(0)\n\t\t}\n\t}\n\n\thandlePlayPause = () => {\n\t\tconst { paused, current, shift } = this.state\n\t\ttry {\n\t\t\tnavigator.vibrate(100)\n\t\t} catch (err) {}\n\n\t\tif (paused) {\n\t\t\tconst now = Date.now()\n\t\t\tconst newShift = shift + (now - current)\n\n\t\t\tthis.setState({ paused: false, shift: newShift })\n\t\t\tthis.performTick()\n\t\t\t\n\t\t\tif (this.ref) {\n\t\t\t\tthis.ref.scrollLeft = newShift / DAY_LENGTH * this.ref.offsetWidth * SIZE_MULTIPLIER\n\t\t\t}\n\t\t\t\n\t\t\tthis.onShift(newShift)\n\t\t} else {\n\t\t\tthis.setState({ paused: true })\n\t\t\tthis.props.onStop()\n\t\t}\n\t}\n\n\thandleShift = (seconds: number) => {\n\t\tconst px = (seconds * 1000) / TIME_PER_PIXEL\n\t\tif (this.ref) {\n\t\t\tthis.ref.scrollLeft = Math.max(0, Math.min(MAX_LENGTH / TIME_PER_PIXEL, this.ref.scrollLeft + px))\n\t\t}\n  }\n\n\thandleShiftRight = () => this.handleShift(30)\n\n\thandleShiftLeft = () => this.handleShift(-30)\n\n\trender() {\n\t\tconst { current, shift, paused, visible, scenes } = this.state\n\n\t\treturn (\n\t\t\t<div className={styles.timeline} style={{ opacity: visible ? 1 : 0 }}>\n\t\t\t\t<div className={styles.position}>\n\t\t\t\t\t<div className={styles.button} onClick={this.handleShiftLeft}>⏪</div>\n\t\t\t\t\t<div className={styles.bubble}>\n\t\t\t\t\t\t{new Date(current - shift).toLocaleString()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={styles.button} onClick={this.handleShiftRight}>⏩</div>\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.scrobber} ref={this.addRef}>\n\t\t\t\t\t<Timeline current={current} scenes={scenes} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)\n\t}\n}","export const HOST = 'doma.duong.cz'\nexport const API_URL = `http://${HOST}:8082`","import React, { Component } from 'react'\n\nimport styles from './Camera.module.css'\nimport Live from '../../components/Live/Live'\nimport Dvr from '../../components/Dvr/Dvr'\nimport Scrobber from '../../components/Scrobber/Scrobber'\n\nimport { API_URL } from '../../constants'\n\ntype Props = {\n  name: string,\n  streams: {\n    port: number,\n    name: string,\n    key: string,\n  }[],\n}\n\n\ntype State = {\n  from: number,\n  to: number,\n  shift: number,\n  showTools: boolean,\n}\n\nexport default class Camera extends Component<Props, State> {\n  state: State = {\n    from: 0,\n    to: 0,\n    shift: 0,\n    showTools: false,\n  }\n  \n  generateUrl = ({ name, from, to, shift }: { name: string, from: number, to: number, shift: number }): string | null => {\n    if (!shift && !from && !to) return null\n    \n    let baseUrl = `${API_URL}/data/${name}/`\n    let type = 'stream.m3u8'\n\n    let params = []\n    if (from > 0) {\n      type = 'slice.m3u8'\n      params.push(`from=${from}`)\n\n      if (to > 0 && from < to) {\n        params.push(`to=${to}`)\n      }\n    } else if (shift > 0) {\n      params.push(`shift=${shift}`)\n    }\n\n    baseUrl += type\n    if (params.length > 0) {\n      baseUrl += '?' + params.join('&')\n    }\n\n    return baseUrl\n  }\n\n  componentWillUpdate(newProps: Props) {\n    if (this.props.name !== newProps.name) {\n      this.setState({ from: 0, to: 0, shift: 0 })\n    }\n  }\n\n  handlePause = () => {\n    console.log('handling pause')\n  }\n\n  handleShiftChange = (shift: number) => {\n    console.log(shift)\n    this.setState({ shift })\n  }\n\n  render() {\n    const { name } = this.props\n    const { from, to, shift } = this.state\n    const url = this.generateUrl({ name, from, to, shift })\n\n    return (\n      <div className={styles.camera}>\n        { url && url.indexOf('http') === 0 && <Dvr source={url} /> }\n        { url && url.indexOf('ws') === 0 && <Live source={url} /> }\n        <Scrobber onShift={this.handleShiftChange} onStop={this.handlePause} name={name} />\n      </div>\n    )\n  }\n}\n","import React, { Component } from 'react'\nimport { BrowserRouter as Router, Route, RouteComponentProps } from 'react-router-dom'\n\nimport Menu from './components/Menu/Menu';\nimport Home from './routes/Home/Home';\nimport Camera from './routes/Camera/Camera';\n\nimport { API_URL } from './constants'\n\nexport default class App extends Component {\n\n\tstate = {\n\t\tstreams: [],\n\t}\n\n\tcomponentDidMount() {\n\t\tfetch(`${API_URL}/streams`, {\n      headers: {\n        'Authorization': `Basic ${btoa('duong.cz:1974hoangdathongvinhvinhhongdathoang1303')}`,\n      },\n      credentials: 'include',\n    })\n\t\t\t.then(a => a.json())\n\t\t\t.then(({ data }) => {\n\t\t\t\tthis.setState({ streams: data })\n\t\t\t})\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div id=\"app\">\n\t\t\t\t<Menu streams={this.state.streams} />\n\t\t\t\t<Router>\n\t\t\t\t\t<Route path=\"/\" component={Home} />\n\t\t\t\t\t<Route path=\"/camera/:name\" render={({ match }: RouteComponentProps<{ name: string }>) => (<Camera name={match.params.name} streams={this.state.streams} />)} />\n\t\t\t\t</Router>\n\t\t\t</div>\n\t\t);\n\t}\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}