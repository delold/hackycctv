{"version":3,"sources":["components/Scrobber/Scrobber.module.css","routes/Camera/Camera.module.css","utils/dataProvider.ts","utils/constants.ts","components/RefreshImg/RefreshImg.tsx","routes/Home/Home.tsx","components/HLSArchive/HLSArchive.tsx","components/MediaSourceLive/MediaSourceLive.tsx","utils/vibrateDecorator.ts","components/Scrobber/Scrobber.tsx","routes/Camera/Camera.tsx","App.tsx","index.tsx","routes/Home/Home.module.css"],"names":["module","exports","timeline","center","btn","pill","cover","live","circle","scrobber","slider","day","position","bubble","button","hidden","camera","log","provider","createContext","streams","HOST","window","location","hostname","API_URL","concat","COLORS","RefreshImg","_ref","src","props","Object","objectWithoutProperties","_useState","useState","Date","now","_useState2","slicedToArray","session","setSession","ref","useRef","useEffect","current","setInterval","clearInterval","react_default","a","createElement","assign","Home","className","styles","list","dataProvider","Consumer","map","_ref2","index","key","name","react_router_dom","to","item","header","color","style","backgroundColor","length","video","RefreshImg_RefreshImg","alt","HLSArchive","hls","timer","videoRef","_this","handlePlayback","autoplay","play","source","console","clearTimeout","Hls","isSupported","pause","destroy","loadSource","attachMedia","on","Events","MANIFEST_PARSED","setTimeout","this","oldProps","autoPlay","muted","playsInline","Component","MediaSourceLive","delayLog","useLayoutEffect","mediaSource","MediaSource","frameBuffer","closing","socket","sourceBuffer","objectUrl","pendingDelay","attemptToPlay","err","error","sourceBuffers","addEventListener","ev","targetBuffer","mode","onupdateend","buffered","onupdate","updating","shift","performance","appendBuffer","createSocket","url","sendAck","WebSocket","binaryType","onmessage","data","push","send","onerror","close","onclose","undefined","addSourceBuffer","URL","createObjectURL","revokeObjectURL","vibrateDecorator","callback","navigator","vibrate","apply","arguments","MAX_LENGTH","Scrobber","debounce","interval","timeout","sceneTimer","state","visible","scenes","onShift","newShift","Math","max","min","setState","ceil","performTick","getMilliseconds","extendOpacity","handleLive","handleShiftRight","handleShiftLeft","handleTimeChange","value","_value$split$map","split","Number","parseInt","_value$split$map2","hours","minutes","moment","past","clone","subtract","diff","handleDateChange","seconds","milliseconds","document","removeEventListener","_this2","_this$state","date","minRangeRounded","maxRangeRounded","minDate","maxDate","opacity","back","join","width","height","viewBox","fill","xmlns","d","onClick","time","onChange","e","target","format","type","calendar","valueAsDate","Camera","from","debugDelay","showTools","generateUrl","baseUrl","params","handlePause","handleShiftChange","newProps","HLSArchive_HLSArchive","add","Scrobber_Scrobber","onStop","App","setStreams","fetch","then","json","Provider","id","react_router","exact","path","component","render","match","Camera_Camera","ReactDOM","src_App","getElementById"],"mappings":"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","file":"static/js/main.65d013ad.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"timeline\":\"Scrobber_timeline__3L5xh\",\"center\":\"Scrobber_center__1x6s3\",\"btn\":\"Scrobber_btn__4ZN4O\",\"pill\":\"Scrobber_pill__1Tt_u\",\"cover\":\"Scrobber_cover__2xYjK\",\"live\":\"Scrobber_live__3pa3P\",\"circle\":\"Scrobber_circle__2v6Fb\",\"scrobber\":\"Scrobber_scrobber__2SMqh\",\"slider\":\"Scrobber_slider__1CLNR\",\"day\":\"Scrobber_day__2Hioa\",\"position\":\"Scrobber_position__2rj4i\",\"bubble\":\"Scrobber_bubble__39Rsn\",\"button\":\"Scrobber_button__JRLJi\",\"hidden\":\"Scrobber_hidden__2XP4A\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"camera\":\"Camera_camera__1_9vQ\",\"log\":\"Camera_log__TLUoQ\"};","import { createContext } from 'react'\n\nconst provider = createContext({ streams: [] })\nexport default provider","const HOST = window.location.hostname\nconst PORT = 80\n\nexport const API_URL = `http://${HOST}:${PORT}`\nexport const WS_URL = `ws://${HOST}:${PORT}`\nexport const COLORS = [\n  '#EB5757', '#F2994A', '#F2C94C', '#219653', '#6FCF97', '#2F80ED',\n  '#2D9CDB', '#56CCF2', '#9B51E0'\n]","import React, { useEffect, useState, useRef } from 'react';\nexport const RefreshImg = ({ src, ...props }: {\n  src: string | null;\n  [rest: string]: any;\n}) => {\n  const [session, setSession] = useState(Date.now());\n  const ref = useRef<number>();\n  useEffect(() => {\n    ref.current = window.setInterval(() => {\n      setSession(Date.now());\n    }, 15 * 1000);\n    return () => {\n      window.clearInterval(ref.current);\n    };\n  }, []);\n  return <img src={`${src}?q=${session}`} {...props} />;\n};\n","import React from 'react'\nimport DataProvider from '../../utils/dataProvider'\n\nimport styles from './Home.module.css'\nimport { COLORS, API_URL } from 'utils/constants';\nimport { NavLink } from 'react-router-dom';\nimport { RefreshImg } from '../../components/RefreshImg/RefreshImg';\n\nexport default () => {\n  return (\n    <div>\n      <div className={styles.list}>\n        <DataProvider.Consumer>\n          {({ streams }) => streams.map(({ key, name }, index) => (\n            <NavLink to={`/camera/${key}`}>\n              <article className={styles.item} key={key}>\n                <section className={styles.header}>\n                  <h2 className={styles.name}>{name}</h2>\n                  <span className={styles.color} style={{ backgroundColor: COLORS[index % COLORS.length] }}></span>\n                </section>\n                <div className={styles.video}>\n                  <RefreshImg src={`${API_URL}/frame/${key}`} alt={name} />\n                </div>\n              </article>\n            </NavLink>\n          ))}\n        </DataProvider.Consumer>\n      </div>\n    </div>\n  )\n}","import React, { Component } from 'react'\nimport Hls from 'hls.js'\nimport style from './HLSArchive.module.css'\n\ntype Props = {\n  source: string,\n}\n\nexport default class HLSArchive extends Component<Props> {\n  hls: Hls | null = null\n  timer: number | null  = null\n  ref: HTMLVideoElement | null = null\n\n  componentDidMount() {\n    this.handlePlayback()\n  }\n\n  componentDidUpdate(oldProps: Props) {\n    if (oldProps.source !== this.props.source) {\n      this.handlePlayback()\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.timer !== null) {\n      clearTimeout(this.timer)\n    }\n\n    if (this.ref) {\n      this.ref.pause()\n    }\n    if (this.hls) {\n      this.hls.destroy()\n    }\n  }\n\n  videoRef = (ref: HTMLVideoElement) => {\n    this.ref = ref\n    this.handlePlayback()\n  }\n\n  autoplay: TimerHandler = () => {\n    if (this.ref) this.ref.play()\n  }\n\n  handlePlayback = () => {\n    const { source } = this.props\n\n    console.log(source)\n\n    if (source && this.ref) {\n      if (this.timer !== null) {\n        clearTimeout(this.timer)\n      }\n      \n      if (Hls.isSupported()) {\n        if (this.hls) {\n          this.ref.pause()\n          this.hls.destroy()\n        }\n\n        this.hls = new Hls()\n        this.hls.loadSource(source)\n        this.hls.attachMedia(this.ref)\n        this.hls.on(Hls.Events.MANIFEST_PARSED, () => {\n          this.timer = setTimeout(this.autoplay, 300)\n        })\n      } else {\n        this.ref.src = source\n        this.timer = setTimeout(this.autoplay, 300)\n      }\n    }\n  }\n\n  render() {\n    return <video className={style.video} ref={this.videoRef} autoPlay muted playsInline />\n  }\n}\n","import React, { useRef, useLayoutEffect } from 'react'\n\ntype Props = {\n  delayLog: (delay: number) => any,\n}\n\nexport default ({ delayLog }: Props) => {\n  const videoRef = useRef<HTMLVideoElement>(null)\n\n  useLayoutEffect(() => {\n    const mediaSource = new MediaSource()\n    const frameBuffer: ArrayBuffer[] = []\n    \n    let closing = false\n    let socket: WebSocket | null = null\n    let socketTimer: number | undefined = undefined\n    let sourceBuffer: SourceBuffer | null = null\n    let objectUrl: string | null = null\n\n    let pendingDelay: number | null = null\n\n    const attemptToPlay = () => {\n      try {\n        if (videoRef.current) videoRef.current.play()\n      } catch (err) {\n        console.error(err)\n      }\n    }\n\n    const createSocket = (url: string) => {\n      let sendAck = false\n      socket = new WebSocket(url)\n      \n      socket.binaryType = 'arraybuffer'\n      socket.onmessage = ({ data }) => {\n        try {\n          if (!sourceBuffer) return\n          if (sourceBuffer.updating || frameBuffer.length > 0) {\n            if (frameBuffer.length == 0) pendingDelay = performance.now()\n            frameBuffer.push(data)\n          } else {\n            sourceBuffer.appendBuffer(data)\n          }\n\n          if (sendAck === false && socket != null) {\n            sendAck = true\n            socket.send(\"ack\")\n          }\n        } catch (err) {\n          console.error(err)\n        }\n      }\n      socket.onerror = () => socket && socket.close()\n      socket.onclose = () => {\n        if (closing) return\n        window.clearTimeout(socketTimer)\n        window.setTimeout(() => createSocket(url), 1000)\n      }\n    }\n\n    mediaSource.sourceBuffers.addEventListener('addsourcebuffer', (ev) => {\n      const targetBuffer = mediaSource.sourceBuffers[0]\n      targetBuffer.mode = \"sequence\"\n      \n      targetBuffer.onupdateend = () => console.log('onupdateend', targetBuffer.buffered.length)\n      targetBuffer.onupdate = () => {\n        if (!sourceBuffer) return\n        if (frameBuffer.length > 0 && !sourceBuffer.updating) {\n          const item = frameBuffer.shift()\n\n          if (frameBuffer.length == 0 && pendingDelay !== null) {\n            delayLog(performance.now() - pendingDelay)\n            pendingDelay = null\n          }\n          if (item) sourceBuffer.appendBuffer(item)\n        }\n\n        attemptToPlay()\n      }\n\n      sourceBuffer = targetBuffer\n      createSocket('ws://localhost:8080')\n    })\n\n    mediaSource.addEventListener('sourceopen', () => {\n      attemptToPlay()\n      mediaSource.addSourceBuffer('video/mp4; codecs=\"avc1.42001f\"')\n    })\n\n    mediaSource.addEventListener('sourceended', (ev) => {\n      console.log(ev)\n    })\n\n    if (videoRef.current != null) {\n      objectUrl = window.URL.createObjectURL(mediaSource)\n      videoRef.current.src = objectUrl\n    }\n\n    return () => {\n      closing = true\n      if (socket) socket.close()\n      window.clearTimeout(socketTimer)\n      if (objectUrl) window.URL.revokeObjectURL(objectUrl)\n    }\n  }, [])\n\n  return (\n    <video ref={videoRef} />\n  )\n}","export const vibrateDecorator = (callback: (...args: any) => any) => {\n\treturn (...args: any): any => {\n\t\ttry {\n\t\t\tnavigator.vibrate(200);\n\t\t}\n\t\tcatch (err) { }\n\t\treturn callback(...args);\n\t};\n};\n","import React, { Component } from 'react'\nimport { NavLink } from 'react-router-dom'\nimport moment from 'moment'\n\nimport { vibrateDecorator } from '../../utils/vibrateDecorator'\nimport styles from './Scrobber.module.css'\n\ntype Scene = {\n  timestamp: number,\n  scene: number,\n}\n\ntype Props = {\n\tonShift: (shift: number) => void,\n  onStop: () => void,\n  name: string,\n}\n\ntype State = {\n\tshift: number,\n  current: number,\n  visible: boolean,\n  scenes: Scene[]\n}\n\nconst DAY_LENGTH = 24 * 60 * 60 * 1000\nconst MAX_LENGTH = 7 * DAY_LENGTH\n\nexport default class Scrobber extends Component<Props, State> {\n  debounce: number | null = null\n  interval: number | null = null\n  timeout: number | null = null\n  sceneTimer: number | null = null\n  timer: number | null = null\n  ref: HTMLDivElement | null = null\n\n\tstate = {\n\t\tshift: 0,\n\t\tcurrent: Date.now(),\n\t\tvisible: true,\n\t\tscenes: [],\n\t}\n\n\tonShift = (newShift: number) => {\n\t\tconst shift = Math.max(0, Math.min(MAX_LENGTH, newShift))\n\t\tthis.setState({ shift })\n    this.props.onShift(Math.ceil(shift / 1000))\n\t}\n\n\tperformTick = () => {\n\t\tif (!this.interval) {\n\t\t\tthis.interval = 0\n\t\t}\n\t\t\n\t\tconst current = Date.now()\n    this.setState({ current })\n    \n    if (this.timer !== null) {\n      clearTimeout(this.timer)\n    }\n\n    const callback: TimerHandler = this.performTick\n\t\tthis.timer = setTimeout(callback, Math.max(1000 - new Date(current).getMilliseconds(), 0))\n\t}\n\n\textendOpacity = () => {\n    this.setState({ visible: true })\n    \n    if (this.timeout) {\n      clearTimeout(this.timeout)\n    }\n\n    const callback: TimerHandler = () => this.setState({ visible: false })\n\t\tthis.timeout = setTimeout(callback, 8000)\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.extendOpacity()\n\t\tdocument.addEventListener('touchstart', this.extendOpacity)\n\t\tdocument.addEventListener('mousedown', this.extendOpacity)\n\t\tdocument.addEventListener('mousemove', this.extendOpacity)\n\t\t\n\t\tthis.performTick()\n\t}\n\n\tcomponentWillUnmount() {\n\t\tdocument.removeEventListener('mousedown', this.extendOpacity)\n\n\t\tif (this.timer) clearTimeout(this.timer)\n\t\tif (this.debounce) clearTimeout(this.debounce)\n\t\tif (this.timeout) clearTimeout(this.timeout)\n\t\tif (this.sceneTimer) clearTimeout(this.sceneTimer)\n\t}\n\n\thandleLive = vibrateDecorator(() => this.onShift(0))\n\thandleShiftRight = vibrateDecorator(() => this.onShift(this.state.shift + 30000))\n\thandleShiftLeft = vibrateDecorator(() => this.onShift(this.state.shift - 30000))\n\n\thandleTimeChange = (value: string) => {\n\t\tconst [hours, minutes] = value.split(':').map(item => Number.parseInt(item, 10))\n\t\t\n\t\tconst now = moment()\n\t\tconst past = now.clone().subtract(this.state.shift, 'milliseconds')\n\t\t\t.hours(hours)\n\t\t\t.minutes(minutes)\n\n\t\tthis.onShift(now.diff(past))\n\t}\n\t\n\thandleDateChange = (value: Date | null) => {\n\t\tif (!value) return\n\t\tconst now = moment()\n\t\tconst ref = moment().subtract(this.state.shift, 'milliseconds')\n\t\tconst past = moment(value)\n\t\t\t.hours(ref.hours())\n\t\t\t.minutes(ref.minutes())\n\t\t\t.seconds(ref.seconds())\n\t\t\t.milliseconds(ref.milliseconds())\n\n\t\tthis.onShift(now.diff(past))\n\t}\n\n\trender() {\n\t\tconst { current, shift, visible } = this.state\n\t\tconst date = moment(new Date(current - shift))\n\n\t\tlet minRangeRounded = current - MAX_LENGTH\n\t\tminRangeRounded -= minRangeRounded % (60 * 1000)\n\n\t\tlet maxRangeRounded = current\n\t\tmaxRangeRounded += (60 * 1000) - maxRangeRounded % (60 * 1000)\n\n\t\tconst minDate = moment(new Date(minRangeRounded))\n\t\tconst maxDate = moment(new Date(maxRangeRounded))\n\n\t\treturn (\n\t\t\t<div className={styles.timeline} style={{ opacity: visible ? 1 : 0 }}>\n\t\t\t\t<NavLink to=\"/\">\n\t\t\t\t\t<a className={[styles.btn, styles.circle, styles.back].join(' ')}>\n\t\t\t\t\t\t<svg width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t<path d=\"M21 9.17424V11.8258H5.09091L12.3826 19.1174L10.5 21L0 10.5L10.5 0L12.3826 1.88258L5.09091 9.17424H21Z\" fill=\"currentColor\"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</a>\n\t\t\t\t</NavLink>\n\n\t\t\t\t<div className={styles.center}>\n\t\t\t\t\t<button className={[styles.btn, styles.circle, styles.shift].join(' ')} onClick={this.handleShiftLeft}>\n\t\t\t\t\t\t<svg width=\"21\" height=\"14\" viewBox=\"0 0 21 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t<path d=\"M16 0H13V14H16V0ZM11 0L0 7L11 14V0ZM21 0H18V14H21V0Z\" fill=\"currentColor\"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t<div className={[styles.time, styles.btn, styles.pill].join(' ')}>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclassName={styles.cover}\n\t\t\t\t\t\t\tonChange={(e) => this.handleTimeChange(e.target.value)}\n\t\t\t\t\t\t\tvalue={date.format('HH:mm')}\n\t\t\t\t\t\t\tmin={minDate.format('HH:mm')}\n\t\t\t\t\t\t\tmax={maxDate.format('HH:mm')}\n\t\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{date.format('HH:mm:ss')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div className={[styles.calendar, styles.btn, styles.pill].join(' ')}>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tclassName={styles.cover}\n\t\t\t\t\t\t\tonChange={(e) => this.handleDateChange(e.target.valueAsDate)}\n\t\t\t\t\t\t\tvalue={date.format('YYYY-MM-DD')}\n\t\t\t\t\t\t\tmin={minDate.format('YYYY-MM-DD')}\n\t\t\t\t\t\t\tmax={maxDate.format('YYYY-MM-DD')}\n\t\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{date.format('DD. MMMM YYYY')}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<button className={[styles.btn, styles.circle, styles.shift].join(' ')} onClick={this.handleShiftRight}>\n\t\t\t\t\t\t<svg width=\"21\" height=\"14\" viewBox=\"0 0 21 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t<path d=\"M5 0H8V14H5V0ZM10 0L21 7L10 14V0ZM0 0H3V14H0V0Z\" fill=\"currentColor\"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<button className={[styles.btn, styles.pill, styles.live].join(' ')} onClick={this.handleLive}>\n\t\t\t\t\t<svg width=\"26\" height=\"26\" viewBox=\"0 0 26 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t<path d=\"M25.4983 10.3367H15.8933L19.7749 6.34167C15.9074 2.51667 9.64578 2.375 5.77828 6.2C1.91078 10.0392 1.91078 16.23 5.77828 20.0833C9.64578 23.9083 15.9074 23.9083 19.7749 20.0833C21.7016 18.1708 22.6649 15.9467 22.6649 13.1417H25.4983C25.4983 15.9467 24.2516 19.5875 21.7583 22.0525C16.7858 26.9825 8.71078 26.9825 3.73828 22.0525C-1.22006 17.1367 -1.26256 9.14667 3.70994 4.23083C8.68244 -0.685 16.6583 -0.685 21.6308 4.23083L25.4983 0.25V10.3367ZM13.4566 7.33333V13.3542L18.4149 16.3008L17.3949 18.015L11.3316 14.4167V7.33333H13.4566Z\" fill=\"currentColor\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span>Živý přenos</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t)\n\t}\n}","import React, { Component } from 'react'\n\nimport styles from './Camera.module.css'\nimport Dvr from '../../components/HLSArchive/HLSArchive'\nimport MediaSourceLive from '../../components/MediaSourceLive/MediaSourceLive'\nimport Scrobber from '../../components/Scrobber/Scrobber'\n\nimport { API_URL } from '../../utils/constants'\n\ntype Props = {\n  name: string,\n  streams: {\n    port: number,\n    name: string,\n    key: string,\n  }[],\n}\n\n\ntype State = {\n  from: number,\n  to: number,\n  shift: number,\n  debugDelay: number,\n  showTools: boolean,\n}\n\nexport default class Camera extends Component<Props, State> {\n  state: State = {\n    from: 0,\n    to: 0,\n    shift: 0,\n    debugDelay: 0,\n    showTools: false,\n  }\n  \n  generateUrl = ({ name, from, to, shift }: { name: string, from: number, to: number, shift: number }): string | null => {\n    // if (!shift && !from && !to) return null\n    \n    let baseUrl = `${API_URL}/data/${name}/`\n    let type = 'stream.m3u8'\n\n    let params = []\n    if (from > 0) {\n      type = 'slice.m3u8'\n      params.push(`from=${from}`)\n\n      if (to > 0 && from < to) {\n        params.push(`to=${to}`)\n      }\n    } else if (shift > 0) {\n      params.push(`shift=${shift}`)\n    }\n\n    baseUrl += type\n    if (params.length > 0) {\n      baseUrl += '?' + params.join('&')\n    }\n\n    return baseUrl\n  }\n\n  componentWillUpdate(newProps: Props) {\n    if (this.props.name !== newProps.name) {\n      this.setState({ from: 0, to: 0, shift: 0 })\n    }\n  }\n\n  handlePause = () => {\n    console.log('handling pause')\n  }\n\n  handleShiftChange = (shift: number) => {\n    console.log(shift)\n    this.setState({ shift })\n  }\n\n  render() {\n    const { name } = this.props\n    const { from, to, shift, debugDelay } = this.state\n    const url = this.generateUrl({ name, from, to, shift })\n\n    return (\n      <div className={styles.camera}>\n        { debugDelay && <div className={styles.log}>\n          {debugDelay} ms\n        </div> }\n        { url && <Dvr source={url} /> }\n        { !url && <MediaSourceLive delayLog={(add: number) => {\n          this.setState({ debugDelay: this.state.debugDelay + add })\n        }} /> }\n        <Scrobber onShift={this.handleShiftChange} onStop={this.handlePause} name={name} />\n      </div>\n    )\n  }\n}\n","import React, { useState, useEffect } from 'react'\nimport { BrowserRouter as Router, Route, RouteComponentProps } from 'react-router-dom'\n\nimport Home from './routes/Home/Home'\nimport Camera from './routes/Camera/Camera'\n\nimport { API_URL } from './utils/constants'\nimport DataContext from './utils/dataProvider'\n\n\nconst App = () => {\n\tconst [streams, setStreams] = useState([])\n\t\t\n\tuseEffect(() => {\n\t\tfetch(`${API_URL}/streams`).then((a) => a.json()).then(({ data }) => setStreams(data))\n\t}, [])\n\n\treturn (\n\t\t<Router>\n\t\t\t<DataContext.Provider value={{ streams }}>\n\t\t\t\t<div id=\"app\">\n\t\t\t\t\t<Route exact path=\"/\" component={Home} />\n\t\t\t\t\t<Route path=\"/camera/:name\" render={({ match }: RouteComponentProps<{ name: string }>) => (<Camera name={match.params.name} streams={streams} />)} />\n\t\t\t\t</div>\n\t\t\t</DataContext.Provider>\n\t\t</Router>\n\t)\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"Home_item__2ZH6b\",\"header\":\"Home_header__1C8Uc\",\"color\":\"Home_color__fYjfc\",\"name\":\"Home_name__1FDy3\",\"video\":\"Home_video__32sq0\",\"list\":\"Home_list__2TVHk\"};"],"sourceRoot":""}